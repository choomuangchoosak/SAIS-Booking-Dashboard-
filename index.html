<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Schindler Safety Clearance</title>
    <style>
        :root {
            --schindler-red: #E00000;
            --schindler-black: #000000;
            --schindler-white: #FFFFFF;
            --schindler-grey: #F2F2F2;
            --pass-green: #1e8e3e;
            --fail-red: #d93025;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: var(--schindler-grey); 
            margin: 0; padding: 0; 
            color: var(--schindler-black);
            font-size: 18px; /* Body typography 18px */
        }

        header {
            background-color: var(--schindler-red);
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: sticky; top: 0; z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        header h2 { 
            margin: 0; font-size: 22px; /* AppBar typography 22px */
            text-transform: uppercase; letter-spacing: 1px;
        }

        .container { 
            max-width: 500px; margin: 0 auto; padding: 25px 20px; 
        }

        .card { 
            background: var(--schindler-white); 
            border-radius: 20px; 
            padding: 25px; 
            box-shadow: var(--shadow); 
            margin-bottom: 25px;
        }

        .diagram-grid {
            display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 20px;
        }
        .diagram-grid img { width: 100%; border-radius: 12px; border: 1px solid #ddd; }

        .section-title {
            color: var(--schindler-red); font-weight: 800;
            font-size: 16px; margin: 25px 0 15px 5px;
            text-transform: uppercase; border-left: 4px solid var(--schindler-red);
            padding-left: 10px;
        }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; color: #444; }
        
        input { 
            width: 100%; padding: 16px; 
            border: 2px solid #555; border-radius: 12px; 
            font-size: 1.1rem; outline: none; transition: 0.2s;
            background-color: #fff;
        }
        input:focus { border-color: var(--schindler-red); background-color: #fff8f8; }

        .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

        .y-display {
            background: var(--schindler-black); color: white;
            padding: 30px 20px; border-radius: 20px; text-align: center;
            margin: 25px 0; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        .y-display span { font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.7; }
        .y-display div { font-size: 45px; font-weight: 900; font-family: monospace; margin-top: 5px; }

        .safety-card {
            border: 2px solid #eee; padding: 20px; border-radius: 20px;
            margin-bottom: 15px; transition: 0.3s;
        }
        .safety-card.pass { border-color: var(--pass-green); background-color: #f0fff4; }
        .safety-card.fail { border-color: var(--fail-red); background-color: #fff5f5; }

        .calc-btn {
            width: 100%; padding: 20px; background: var(--schindler-red);
            color: white; border: none; border-radius: 50px;
            font-size: 1.1rem; font-weight: 800; cursor: pointer;
            box-shadow: 0 8px 20px rgba(224, 0, 0, 0.3);
            text-transform: uppercase; margin: 20px 0;
            transition: 0.3s;
        }
        .calc-btn:active { transform: scale(0.98); }

        /* Summary Dashboard */
        .summary-dashboard {
            background: white; border-radius: 20px; overflow: hidden;
            border: 2px solid #eee; box-shadow: var(--shadow);
        }
        .summary-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 18px 20px; border-bottom: 1px solid #eee;
        }
        .sum-label { font-weight: 600; font-size: 0.9rem; }
        .sum-val { font-family: monospace; font-weight: 700; }

        /* Modal popIn Animation */
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000; align-items: center; justify-content: center;
            padding: 20px;
        }
        .modal-content {
            background: white; width: 100%; max-width: 400px;
            border-radius: 30px; padding: 40px 20px; text-align: center;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-value { font-size: 100px; font-weight: 900; margin: 20px 0; font-family: monospace; }
        .close-btn { 
            background: var(--schindler-black); color: white; border: none;
            padding: 15px 40px; border-radius: 50px; font-weight: 800; cursor: pointer;
        }

        .criteria-box { font-size: 0.75rem; color: #777; padding: 15px; line-height: 1.5; border-top: 1px dashed #ccc; }
    </style>
</head>
<body>

<header>
    <h2>Safety Clearance Pit</h2>
    <div class="version" style="font-size: 12px; opacity: 0.8; margin-top: 5px;">ES1 / ES5.0 / ES5 Rel.02 EN 81-1</div>
</header>

<div class="container">
    <div class="card">
        
        <div class="diagram-grid">
            <img src="image/layout-pit.jpeg" alt="Layout Diagram">
        </div>

        <div class="section-title">Base Data</div>
        <div class="input-group">
            <label>X (ลิฟต์จอดไม่เสมอชั้น ซิลในถึงซิลนอก)</label>
            <input type="number" id="X" oninput="calculate()">
        </div>
        <div class="input-group">
            <label>HKP + X (บัฟเฟอร์ถึงเพลทใต้ตู้)</label>
            <input type="number" id="HKPX" oninput="calculate()">
        </div>
        <div class="input-group">
            <label>HPHK (Buffer Stroke)</label>
            <input type="number" id="HPH" oninput="calculate()">
        </div>
        <div class="input-row">
            <div class="input-group">
                <label>HKP Min (Spec)</label>
                <input type="number" id="HKP_Spec_Min" oninput="calculate()">
            </div>
            <div class="input-group">
                <label>HKP Max (Spec)</label>
                <input type="number" id="HKP_Spec_Max" oninput="calculate()">
            </div>
        </div>

        <div class="y-display">
            <span>Total Y (HKP + X + HPHK)</span>
            <div id="outY">0.0</div>
        </div>

        <div class="section-title">Safety Clearance</div>
        <div class="safety-card" id="cardA">
            <label>A (ขอบกระบังซิลถึงผนัง/ที่กั้น)</label>
            <input type="number" id="A" oninput="calculate()">
        </div>
        <div class="safety-card" id="cardE">
            <label>E (Guide shoe ถึงพื้นบ่อ)</label>
            <input type="number" id="E" oninput="calculate()">
        </div>
        <div class="safety-card" id="cardF">
            <label>F (ขอบกระบังซิลถึงพื้นบ่อ)</label>
            <input type="number" id="F" oninput="calculate()">
        </div>
        <div class="safety-card" id="cardG">
            <label>G (ส่วนต่ำสุดพื้นตู้ถึงพื้นบ่อ)</label>
            <input type="number" id="G" oninput="calculate()">
        </div>

        <button class="calc-btn" onclick="showModal()">View Full Summary</button>

        <div class="summary-dashboard" id="inlineSummary">
            <div class="summary-item" style="background:#f9f9f9; font-size: 0.8rem; color: #666; justify-content: center;">LIVE CALCULATION RESULTS</div>
            <div id="inlineResults">
                <div class="summary-item" style="justify-content:center; color:#999; font-style:italic;">Enter data to begin...</div>
            </div>
        </div>

        <div class="criteria-box">
            <b>Criteria:</b> HKP (0/-5mm) | E-Y ≥ 300mm | G-Y ≥ 500mm <br>
            A > 150mm: F-Y ≥ 500mm | A 35-150mm: F-Y ≥ 100mm | A ≤ 35mm: F-Y ≥ 30mm
        </div>

        
        <div class="diagram-grid">
            <img src="image/layout-f.jpeg" alt="Layout F Diagram">
        </div>
    </div>
</div>

<div id="modal">
    <div class="modal-content">
        <div id="modalStatus" style="font-weight: 800; font-size: 20px;">TOTAL Y RESULT</div>
        <div class="modal-value" id="modalY">0</div>
        <div id="modalDetail" style="margin-bottom: 30px; font-weight: 600;"></div>
        <button class="close-btn" onclick="closeModal()">CLOSE</button>
    </div>
</div>

<script>
    let results = {};

    function calculate() {
        const v = (id) => parseFloat(document.getElementById(id).value) || 0;
        
        const x = v('X'), hkpx = v('HKPX'), hph = v('HPH');
        const minSpec = v('HKP_Spec_Min'), maxSpec = v('HKP_Spec_Max');
        const a = v('A'), e = v('E'), f = v('F'), g = v('G');

        const hkp = hkpx - x;
        const y = hkpx + hph;
        const ey = e - y;
        const gy = g - y;
        const fy = f - y;

        results = { hkp, y, ey, gy, fy, a, e, f, g, minSpec, maxSpec };

        document.getElementById('outY').innerText = y.toFixed(1);
        document.getElementById('modalY').innerText = Math.round(y);

        // Analysis
        let hkpPass = (minSpec > 0 && maxSpec > 0) ? (hkp >= minSpec && hkp <= maxSpec) : true;
        let ePass = (ey >= 300);
        let gPass = (gy >= 500);
        
        let fPass = false;
        if (fy >= 500) fPass = true;
        else if (fy >= 100) fPass = (a <= 150);
        else if (fy >= 30) fPass = (a <= 35);

        // Update Cards
        updateCard('cardA', fPass);
        updateCard('cardE', ePass);
        updateCard('cardF', fy >= 30);
        updateInputStatus('cardG', gPass);

        renderDashboard(hkpPass, ePass, gPass, fPass);
    }

    function updateCard(id, isPass) {
        const el = document.getElementById(id);
        const val = parseFloat(el.querySelector('input').value) || 0;
        if (val === 0) el.className = "safety-card";
        else el.className = "safety-card " + (isPass ? "pass" : "fail");
    }

    function renderDashboard(hkpPass, ePass, gPass, fPass) {
        if (!results.y) return;

        const getItem = (label, val, isPass) => `
            <div class="summary-item">
                <span class="sum-label">${label}</span>
                <span class="sum-val" style="color:${isPass ? 'var(--pass-green)' : 'var(--fail-red)'}">${val.toFixed(1)} mm ${isPass ? '✓' : '✗'}</span>
            </div>`;

        let html = "";
        if (results.minSpec > 0) html += getItem('HKP (Runby)', results.hkp, hkpPass);
        html += getItem('E - Y (Min 300)', results.ey, ePass);
        html += getItem('G - Y (Min 500)', results.gy, gPass);
        html += getItem('F - Y (Min 30)', results.fy, results.fy >= 30);

        document.getElementById('inlineResults').innerHTML = html;
    }

    function showModal() {
        if (!results.y) { alert('Please enter base data first.'); return; }
        document.getElementById('modal').style.display = 'flex';
        document.getElementById('modalDetail').innerText = (results.ey >= 300 && results.gy >= 500) ? "PASS: ALL CRITERIA MET" : "FAIL: CHECK DIMENSIONS";
        document.getElementById('modalDetail').style.color = (results.ey >= 300 && results.gy >= 500) ? 'var(--pass-green)' : 'var(--fail-red)';
    }

    function closeModal() { document.getElementById('modal').style.display = 'none'; }
</script>

</body>
</html>
