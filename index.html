<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safety Clearance Headroom Calculator MR/MRL (ES1/ES5/ES5.0)</title>

    <style>
        :root {
            --schindler-red: #E2001A;
            --schindler-dark: #333333;
            --schindler-gray: #F4F4F4;
            --schindler-border: #D1D1D1;
            --focus-blue: #007bff;
            --success: #2ecc71;
            --danger: #e74c3c;
        }

        .sticky-header {
            position: fixed;
            top: 0; left: 0; width: 100%;
            background: var(--schindler-red);
            color: white; text-align: center;
            padding: 10px 0; z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        .sticky-header h1 { margin: 0; font-size: 1.2rem; text-transform: uppercase; }
        .sticky-header small { display: block; font-size: 0.8rem; opacity: 0.9; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--schindler-gray);
            color: var(--schindler-dark);
            margin: 0; padding: 20px; padding-top: 80px;
            display: flex; flex-direction: column; align-items: center;
        }

        .card {
            background: white; padding: 25px; margin-bottom: 20px;
            border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            width: 100%; max-width: 550px; box-sizing: border-box; border: 1px solid #eee;
        }

        h2 { color: var(--schindler-dark); margin-top: 0; font-size: 1.2rem; border-left: 5px solid var(--schindler-red); padding-left: 12px; }
        label { display: block; margin-top: 15px; font-weight: bold; color: #555; font-size: 0.9rem; }

        input, select {
            width: 100%; padding: 12px; margin-top: 8px;
            border-radius: 8px; border: 1px solid var(--schindler-border);
            font-size: 16px; box-sizing: border-box; transition: all 0.2s;
        }

        input:focus { border-color: var(--focus-blue); outline: none; box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1); }
        input[readonly] { background-color: #f9f9f9; color: var(--schindler-red); font-weight: bold; }
        input.fail { background-color: #ffcccc !important; border: 2px solid var(--danger) !important; }

        /* ‡∏õ‡∏∏‡πà‡∏° Calculate ‡πÉ‡∏´‡∏°‡πà */
        .calc-btn {
            width: 100%; padding: 15px; background: var(--schindler-red);
            color: white; border: none; border-radius: 10px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            margin-top: 10px; box-shadow: 0 4px 10px rgba(226, 0, 26, 0.3);
        }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô */
        .status-grid {
            display: grid; grid-template-columns: 1fr; gap: 10px; width: 100%; margin-top: 10px;
        }
        .result-item {
            padding: 15px; border-radius: 10px; color: white;
            text-align: center; font-weight: bold; font-size: 0.95rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .total-y-box {
            background: #333; color: #eee; padding: 15px;
            border-radius: 10px; margin-bottom: 15px; text-align: center;
            border-left: 5px solid var(--schindler-red); font-family: monospace;
        }

        .pass { background: var(--success); }
        .fail-bg { background: var(--danger); }

        .layoutImg { width: 100%; border-radius: 12px; margin-top: 15px; display: none; border: 1px solid #eee; }

        .suggestion-box {
            background: #fff; padding: 15px; border-radius: 10px;
            margin-top: 10px; border-left: 5px solid #f39c12; font-size: 14px; line-height: 1.6;
        }

        /* Modal Popup */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center;
        }
        .modal-content { background: white; border-radius: 12px; width: 90%; max-width: 400px; text-align: center; overflow: hidden; border: 2px solid var(--schindler-red); }
        .modal-header { padding: 15px; font-size: 1.2rem; font-weight: bold; color: white; background: var(--schindler-red); }
        .modal-body { padding: 25px; font-size: 1rem; color: #333; text-align: left; }
        .modal-footer { padding: 15px; background: #f4f4f4; }
        .modal-btn { background: var(--schindler-dark); color: white; border: none; padding: 10px 40px; border-radius: 5px; cursor: pointer; font-weight: bold; }
    </style>
</head>

<body>
    <div class="sticky-header">
        <h1>Safety Clearance Headroom</h1>
        <small>(ES1 / ES5.0 / ES5 Rel. 02 EN 81-1)</small>
    </div>

    <div id="customAlert" class="modal-overlay">
        <div class="modal-content">
            <div id="modalHeader" class="modal-header">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</div>
            <div id="modalBody" class="modal-body"></div>
            <div class="modal-footer"><button class="modal-btn" onclick="closeModal()">‡∏ï‡∏Å‡∏•‡∏á</button></div>
        </div>
    </div>

    <div class="card">
        <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å VKN ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ SKS jump </h2>
        <label>VKN (m/s)</label>
        <select id="vkn" onchange="calculate(false)">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏¥‡∏ü‡∏ï‡πå --</option>
            <option value="0.63">0.63</option><option value="0.80">0.80</option>
            <option value="1.00">1.00</option><option value="1.50">1.50</option>
            <option value="1.60">1.60</option><option value="1.75">1.75</option>
            <option value="2.00">2.00</option><option value="2.50">2.50</option>
            <option value="3.00">3.00</option>
        </select>
        <label>SKS (mm) - ‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î</label>
        <input id="sks" readonly placeholder="‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥">
    </div>

    <div class="card">
        <h2>‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ Buffer HGP,HPHG (mm) </h2>
        <label>HGP =‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏±‡∏ô‡∏ö‡∏≤‡∏¢‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏ß‡∏ó</label>
        <input id="hgp" type="number" placeholder="‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏±‡∏ô‡∏ö‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏ß‡∏ó‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ" oninput="calculate(false)">
        <label>HPHG =‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏∏‡∏ö‡∏Ç‡∏≠‡∏á‡∏ö‡∏±‡∏ü‡πÄ‡∏ü‡∏≠‡∏£‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡πÄ‡∏ß‡∏ó (mm)</label>
        <input id="hphg" type="number" placeholder="‡∏î‡∏π‡∏à‡∏≤‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á" oninput="calculate(false)">
    </div>

    <div class="card">
        <h2>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏•‡∏¥‡∏ü‡∏ï‡πå MR/MRL</h2>
        <select id="layoutSelect" onchange="showLayout()">
            <option value="">--‡πÄ‡∏•‡∏∑‡∏≠‡∏Å MR/MRL--</option>
            <option value="mr">MR Elevator (‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</option>
            <option value="mrl">MRL Elevator (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</option>
        </select>
        <img id="imgMR" class="layoutImg" src="image/layout-mr.jpeg" alt="MR Layout">
        <img id="imgMRL" class="layoutImg" src="image/layout-mrl.jpeg" alt="MRL Layout">
    </div>

    <div class="card">
        <h2>‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞ X A E F G ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ (mm)</h2>
        <label>X =‡∏£‡∏∞‡∏¢‡∏∞‡∏•‡∏¥‡∏ü‡∏ï‡πå‡∏à‡∏≠‡∏î‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡∏±‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î</label>
        <input id="x" type="number" placeholder="‡∏õ‡∏Å‡∏ï‡∏¥ 0" oninput="calculate(false)">
        <label>A =‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ñ‡∏≤‡∏•‡∏¥‡∏ü‡∏ï‡πå ‡∏ñ‡∏∂‡∏á‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏á</label>
        <input id="a" type="number" oninput="calculate(false)">
        <label>E =‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏ñ‡∏∂‡∏á‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏á</label>
        <input id="e" type="number" oninput="calculate(false)">
        <label>F =‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏ß‡∏Å‡∏±‡∏ô‡∏ï‡∏Å ‡∏ñ‡∏∂‡∏á‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏á</label>
        <input id="f" type="number" oninput="calculate(false)">
        <label>G =‡∏£‡∏∞‡∏¢‡∏∞‡∏à‡∏≤‡∏Å Guide shoe ‡∏ñ‡∏∂‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏á‡∏•‡∏¥‡∏ü‡∏ï‡πå</label>
        <input id="g" type="number" oninput="calculate(false)">
        
        <button class="calc-btn" onclick="calculate(true)">CALCULATE / ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    </div>

    <div class="card">
        <h2>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h2>
        <div id="formula" class="total-y-box">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Total Y</div>
        
        <div class="status-grid">
            <div id="resA" class="result-item" style="display:none"></div>
            <div id="resE" class="result-item" style="display:none"></div>
            <div id="resF" class="result-item" style="display:none"></div>
            <div id="resG" class="result-item" style="display:none"></div>
        </div>
        <div id="resAll" class="resultBox" style="margin-top:15px; display:none"></div>
    </div>

    <div id="analysisCard" class="card">
        <h2 style="color: var(--danger);">‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</h2>
        <label>‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡πà‡∏ô‡∏•‡∏á‡∏°‡∏≤ (Hook/Beam)</label>
        <input id="hookDepth" type="number" value="0" oninput="calculate(false)">
        <label>Min HGP (‡∏ï‡∏≤‡∏°‡πÅ‡∏ö‡∏ö)</label>
        <input id="hgpMin" type="number" oninput="calculate(false)">
        <div id="suggestionArea" class="suggestion-box"></div>
    </div>

    <script>
        const sksTable = {"0.63": 14, "0.80": 23, "1.00": 35, "1.50": 79, "1.60": 90, "1.75": 108, "2.00": 140, "2.50": 219, "3.00": 315};

        function showLayout() {
            const layout = document.getElementById("layoutSelect").value;
            document.getElementById("imgMR").style.display = (layout === "mr") ? "block" : "none";
            document.getElementById("imgMRL").style.display = (layout === "mrl") ? "block" : "none";
        }

        function closeModal() { document.getElementById("customAlert").style.display = "none"; }

        function calculate(showPop) {
            const vknValue = document.getElementById("vkn").value;
            const SKS = sksTable[vknValue] || 0;
            document.getElementById("sks").value = SKS;

            const HGP = parseFloat(document.getElementById("hgp").value) || 0;
            const HPHG = parseFloat(document.getElementById("hphg").value) || 0;
            const X = parseFloat(document.getElementById("x").value) || 0;
            const A = parseFloat(document.getElementById("a").value) || 0;
            const E = parseFloat(document.getElementById("e").value) || 0;
            const F = parseFloat(document.getElementById("f").value) || 0;
            const G = parseFloat(document.getElementById("g").value) || 0;

            const Y = SKS + HGP + HPHG + X;
            const Ay = A - Y; const Ey = E - Y; const Fy = F - Y; const Gy = G - Y;

            document.getElementById("formula").innerHTML = `Total Y (HGP+X+HPHG+SKS) = ${SKS} + ${HGP} + ${HPHG} + ${X} = <strong>${Y} mm</strong>`;

            updateBox("resA", Ay, 1000, "A-Y (Headroom)");
            updateBox("resE", Ey, 300, "E-Y (Equipment)");
            updateBox("resF", Fy, 300, "F-Y (Balustrade)");
            updateBox("resG", Gy, 100, "G-Y (Guide Rail)");

            const overall = Ay >= 1000 && Ey >= 300 && Fy >= 300 && Gy >= 100;
            const resAll = document.getElementById("resAll");
            resAll.style.display = "block";
            resAll.className = overall ? "resultBox pass" : "resultBox fail-bg";
            resAll.innerHTML = `Overall : ${overall ? "‡∏ú‡πà‡∏≤‡∏ô ‚úî" : "‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‚úñ"}`;

            if (showPop) {
                const modal = document.getElementById("customAlert");
                const body = document.getElementById("modalBody");
                const head = document.getElementById("modalHeader");
                if (overall) {
                    head.style.background = "#2ecc71"; head.innerHTML = "‚úÖ ‡∏ú‡πà‡∏≤‡∏ô pass";
                    body.innerHTML = "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
                } else {
                    head.style.background = "#E2001A"; head.innerHTML = "‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô fail";
                    let msg = "";
                    if (Ay < 1000) msg += `‚Ä¢ A: ‡∏Ç‡∏≤‡∏î‡πÑ‡∏õ ${1000 - Ay} mm<br>`;
                    if (Ey < 300) msg += `‚Ä¢ E: ‡∏Ç‡∏≤‡∏î‡πÑ‡∏õ ${300 - Ey} mm<br>`;
                    if (Fy < 300) msg += `‚Ä¢ F: ‡∏Ç‡∏≤‡∏î‡πÑ‡∏õ ${300 - Fy} mm<br>`;
                    if (Gy < 100) msg += `‚Ä¢ G: ‡∏Ç‡∏≤‡∏î‡πÑ‡∏õ ${100 - Gy} mm<br>`;
                    body.innerHTML = msg;
                }
                modal.style.display = "flex";
            }

            const analysisCard = document.getElementById("analysisCard");
            if (!overall && vknValue !== "") {
                analysisCard.style.display = "block";
                runAnalysis(Ay, Ey, Fy, Gy, HGP);
            } else { analysisCard.style.display = "none"; }
        }

        function updateBox(id, val, limit, label) {
            const el = document.getElementById(id);
            el.style.display = "block";
            const isPass = val >= limit;
            el.className = `result-item ${isPass ? 'pass' : 'fail-bg'}`;
            const diffText = isPass ? `(‡πÄ‡∏Å‡∏¥‡∏ô‡∏°‡∏≤ ${val - limit} mm)` : `(‡∏Ç‡∏≤‡∏î‡πÑ‡∏õ ${limit - val} mm)`;
            el.innerHTML = `${label}: ${isPass ? '‡∏ú‡πà‡∏≤‡∏ô' : '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô'}<br>${val} ${diffText} / Min ${limit}mm`;
        }

        function runAnalysis(Ay, Ey, Fy, Gy, currentHGP) {
            const hook = parseFloat(document.getElementById("hookDepth").value) || 0;
            const hgpMin = parseFloat(document.getElementById("hgpMin").value) || 0;
            const suggestionArea = document.getElementById("suggestionArea");
            let html = "<strong>üí° ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong><br>";
            const redHGP = currentHGP > hgpMin ? currentHGP - hgpMin : 0;

            if (Ay < 1000 || Ey < 300 || Fy < 300) {
                if (hook > 0) html += `‚Ä¢ ‡∏ï‡∏±‡∏î Hook/Beam (${hook}mm) ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞ A, E, F ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ<br>`;
            }
            if (redHGP > 0) {
                html += `‚Ä¢ ‡∏•‡∏î HGP ‡∏•‡∏á ${redHGP}mm ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ:<br>`;
                html += `  - A ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô ${Ay + redHGP}mm<br>  - E/F ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô ${Ey + redHGP}mm<br>  - G ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô ${Gy + redHGP}mm<br>`;
            }
            suggestionArea.innerHTML = html;
        }
    </script>
</body>
</html>
